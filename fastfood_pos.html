<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íŒ¨ìŠ¤íŠ¸í‘¸ë“œì  í¬ìŠ¤ê¸°</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff6b35">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="íŒ¨ìŠ¤íŠ¸í‘¸ë“œì  í¬ìŠ¤ê¸°">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script src="config.js"></script>
    <script src="user-theme.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'ë§‘ì€ ê³ ë”•', Arial, sans-serif;
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background: #fff;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        .header h1 {
            color: #ff6b35;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 80px);
        }

        /* ìƒë‹¨ ì£¼ë¬¸ í‘œì‹œ ì˜ì—­ */
        .order-display {
            flex: 1;
            background: #fff;
            margin: 10px;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }

        .order-title {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .order-numbers {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 300px;
        }

        .order-item {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(255, 107, 53, 0.3);
            transform: scale(1);
            transition: transform 0.3s ease;
        }

        .order-item.new {
            animation: newOrder 0.5s ease;
        }

        @keyframes newOrder {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* í•˜ë‹¨ ì…ë ¥ ì˜ì—­ */
        .input-section {
            background: #fff;
            margin: 10px;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .number-input {
            width: 100%;
            padding: 15px;
            border: 3px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
            color: #333;
        }

        .number-input:focus {
            outline: none;
            border-color: #ff6b35;
        }

        .number-pad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .number-btn {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            user-select: none;
        }

        .number-btn:active {
            transform: scale(0.95);
        }

        .number-btn.clear {
            background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .action-btn {
            background: linear-gradient(135deg, #2ed573 0%, #1e90ff 100%);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            user-select: none;
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        .action-btn.clear-all {
            background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.3rem;
            }
            
            .order-display {
                margin: 5px;
                padding: 15px;
            }
            
            .input-section {
                margin: 5px;
                padding: 15px;
            }
            
            .number-btn {
                padding: 12px;
                font-size: 1.1rem;
            }
            
            .action-btn {
                padding: 12px;
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>ğŸ” íŒ¨ìŠ¤íŠ¸í‘¸ë“œì  í¬ìŠ¤ê¸° ğŸŸ</h1>
    </div>

    <div class="main-container">
        <!-- ìƒë‹¨ ì£¼ë¬¸ í‘œì‹œ ì˜ì—­ -->
        <div class="order-display">
            <div class="order-title">ğŸ“‹ ì£¼ë¬¸ ëŒ€ê¸° ëª©ë¡</div>
            <div class="order-numbers" id="orderNumbers">
                <div class="order-item" style="opacity: 0.5;">ì£¼ë¬¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ì…ë ¥ ì˜ì—­ -->
        <div class="input-section">
            <input type="text" class="number-input" id="numberInput" placeholder="ì£¼ë¬¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" readonly>
            
            <!-- ìˆ«ì íŒ¨ë“œ -->
            <div class="number-pad">
                <button class="number-btn" onclick="addNumber('1')">1</button>
                <button class="number-btn" onclick="addNumber('2')">2</button>
                <button class="number-btn" onclick="addNumber('3')">3</button>
                <button class="number-btn" onclick="addNumber('4')">4</button>
                <button class="number-btn" onclick="addNumber('5')">5</button>
                <button class="number-btn" onclick="addNumber('6')">6</button>
                <button class="number-btn" onclick="addNumber('7')">7</button>
                <button class="number-btn" onclick="addNumber('8')">8</button>
                <button class="number-btn" onclick="addNumber('9')">9</button>
                <button class="number-btn clear" onclick="clearInput()">C</button>
                <button class="number-btn" onclick="addNumber('0')">0</button>
                <button class="number-btn clear" onclick="deleteLastChar()">â†</button>
            </div>

            <!-- ì•¡ì…˜ ë²„íŠ¼ -->
            <div class="action-buttons">
                <button class="action-btn" onclick="confirmOrder()">âœ… í™•ì¸</button>
                <button class="action-btn clear-all" onclick="clearAllOrders()">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
            </div>
        </div>
    </div>

    <script>
        // ì£¼ë¬¸ ë²ˆí˜¸ ë°°ì—´ (ìµœëŒ€ 3ê°œ)
        let orderNumbers = [];
        let currentInput = '';

        // ìˆ«ì ì…ë ¥
        function addNumber(num) {
            if (currentInput.length < 3) { // ìµœëŒ€ 3ìë¦¬ê¹Œì§€ë§Œ ì…ë ¥ ê°€ëŠ¥
                currentInput += num;
                updateInputDisplay();
            }
        }

        // ì…ë ¥ì°½ ì§€ìš°ê¸°
        function clearInput() {
            currentInput = '';
            updateInputDisplay();
        }

        // ë§ˆì§€ë§‰ ë¬¸ì ì‚­ì œ
        function deleteLastChar() {
            currentInput = currentInput.slice(0, -1);
            updateInputDisplay();
        }

        // ì…ë ¥ì°½ ì—…ë°ì´íŠ¸
        function updateInputDisplay() {
            document.getElementById('numberInput').value = currentInput;
        }

        // ì£¼ë¬¸ í™•ì¸
        function confirmOrder() {
            if (currentInput.trim() === '') {
                alert('ì£¼ë¬¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            const orderNumber = parseInt(currentInput);
            if (orderNumber < 1 || orderNumber > 999) {
                alert('1~999 ì‚¬ì´ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            // ì£¼ë¬¸ ë²ˆí˜¸ ì¶”ê°€ (FIFO ë°©ì‹)
            orderNumbers.push(orderNumber);
            
            // ìµœëŒ€ 3ê°œê¹Œì§€ë§Œ ìœ ì§€
            if (orderNumbers.length > 3) {
                orderNumbers.shift(); // ê°€ì¥ ì˜¤ë˜ëœ ë²ˆí˜¸ ì œê±°
            }

            // í™”ë©´ ì—…ë°ì´íŠ¸
            updateOrderDisplay();
            
            // ì‚¬ìš´ë“œ ì¬ìƒ
            playOrderSound(orderNumber);
            
            // ì…ë ¥ì°½ ì´ˆê¸°í™”
            clearInput();
        }

        // ì£¼ë¬¸ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateOrderDisplay() {
            const orderNumbersContainer = document.getElementById('orderNumbers');
            
            if (orderNumbers.length === 0) {
                orderNumbersContainer.innerHTML = '<div class="order-item" style="opacity: 0.5;">ì£¼ë¬¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>';
                return;
            }

            orderNumbersContainer.innerHTML = '';
            
            orderNumbers.forEach((number, index) => {
                const orderItem = document.createElement('div');
                orderItem.className = 'order-item';
                orderItem.textContent = `${number}ë²ˆ ì†ë‹˜`;
                
                // ìƒˆë¡œ ì¶”ê°€ëœ í•­ëª©ì— ì• ë‹ˆë©”ì´ì…˜ ì ìš©
                if (index === orderNumbers.length - 1) {
                    orderItem.classList.add('new');
                }
                
                orderNumbersContainer.appendChild(orderItem);
            });
        }

        // ì‚¬ìš´ë“œ ì¬ìƒ (Web Speech API ì‚¬ìš©)
        function playOrderSound(orderNumber) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance();
                utterance.text = `${orderNumber}ë²ˆ ì†ë‹˜ ì£¼ë¬¸ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.`;
                utterance.lang = 'ko-KR';
                utterance.rate = 0.8;
                utterance.pitch = 1.0;
                utterance.volume = 1.0;
                
                // ìŒì„± ì¬ìƒ
                speechSynthesis.speak(utterance);
            }
        }

        // ì „ì²´ ì£¼ë¬¸ ì‚­ì œ
        function clearAllOrders() {
            if (orderNumbers.length === 0) {
                alert('ì‚­ì œí•  ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            
            if (confirm('ëª¨ë“  ì£¼ë¬¸ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                orderNumbers = [];
                updateOrderDisplay();
            }
        }

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
        document.addEventListener('keydown', function(event) {
            if (event.key >= '0' && event.key <= '9') {
                addNumber(event.key);
            } else if (event.key === 'Enter') {
                confirmOrder();
            } else if (event.key === 'Backspace') {
                deleteLastChar();
            } else if (event.key === 'Escape') {
                clearInput();
            }
        });

        // í„°ì¹˜ ì´ë²¤íŠ¸ ìµœì í™”
        document.addEventListener('touchstart', function() {}, {passive: true});
        document.addEventListener('touchmove', function() {}, {passive: true});

        // ì´ˆê¸°í™”
        updateOrderDisplay();
    </script>
</body>

</html>
